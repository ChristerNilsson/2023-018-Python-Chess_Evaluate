// Generated by CoffeeScript 2.5.1
var SIZE, split, xdraw;

import _ from 'https://cdn.skypack.dev/lodash';

import {
  ass,
  log,
  range
} from '../js/utils.js';

import {
  Board
} from '../js/board.js';

import {
  Button
} from '../js/button.js';

import {
  Square
} from '../js/square.js';

import {
  makeMove,
  setIndex,
  click,
  fixSuper,
  global
} from '../js/globals.js';

SIZE = global.SIZE;

//global.filename = 'lichess_pgn_2023.03.30_ChristerNilsson_vs_assman69420.HaBJHriw.json'
//global.filename = 'JanChristerNilsson_vs_dn1023_2023.03.29.json'
//global.filename = "lichess_pgn_2023.03.31_Onur1907-06_vs_ChristerNilsson.BFUYknEp.json"
//global.filename = "lichess_pgn_2023.03.31_ChristerNilsson_vs_arapop.kElIgV5u.json"
//global.filename ="lichess_pgn_2023.04.01_MohamedFadel123_vs_ChristerNilsson-D15.MyJVoc2Y.json"
//global.filename ="lichess_pgn_2023.04.01_king1971_vs_ChristerNilsson.7aPwVw9A.json"
//global.filename ="lichess_pgn_2023.04.03_mathewjohn1965_vs_ChristerNilsson.hwnVaJZo.json"
//global.filename = "Bobby Fischer_vs_Boris V Spassky_1992.__.__.json"
global.filename = "Hikaru_vs_______.__.__.json";

window.preload = () => {
  var i, j, len, len1, letter, ref, ref1, results;
  global.data = loadJSON('./data/' + global.filename);
  ref = "rnbqkp";
  for (i = 0, len = ref.length; i < len; i++) {
    letter = ref[i];
    global.pics[letter] = loadImage('./images/b' + letter + '.png');
  }
  ref1 = "RNBQKP";
  results = [];
  for (j = 0, len1 = ref1.length; j < len1; j++) {
    letter = ref1[j];
    results.push(global.pics[letter] = loadImage('./images/w' + letter.toLowerCase() + '.png'));
  }
  return results;
};

// there is a bug in split
split = function(s) {
  if (s === "") {
    return [];
  } else {
    return s.split(" ");
  }
};

window.setup = () => {
  var i, len, move, ref;
  createCanvas(SIZE * 10.3, SIZE * 11);
  textAlign(CENTER, CENTER);
  rectMode(CENTER);
  global.board = new Board();
  // [1, 35, "e5", "c5 d5 c6 Nc6", "e7e5", "c7c5 d7d5 c7c6 b8c6"],
  global.moves = global.data.plies;
  global.moves = _.map(global.moves, (move) => {
    var san, score, scores, superiors, superiorsSan, uci;
    score = move[1];
    san = move[2];
    superiorsSan = split(move[3]);
    uci = move[4];
    superiors = split(move[5]);
    scores = split(move[6]);
    superiorsSan = superiorsSan.slice(0, 12);
    superiors = superiors.slice(0, 12);
    //superiorsSan.reverse()
    //superiors.reverse()
    //scores.reverse()
    return {score, uci, san, superiors, superiorsSan, scores};
  });
  global.piecess.push(global.board.pieces);
  ref = global.moves;
  for (i = 0, len = ref.length; i < len; i++) {
    move = ref[i];
    global.board.pieces = makeMove(move.uci, _.last(global.piecess));
    global.piecess.push(global.board.pieces);
  }
  setIndex(0); // tomt brÃ¤de
  return xdraw();
};

xdraw = () => {
  var button, i, len, ref, results;
  background('gray');
  textSize(SIZE);
  global.board.draw();
  ref = global.buttons;
  results = [];
  for (i = 0, len = ref.length; i < len; i++) {
    button = ref[i];
    results.push(button.draw());
  }
  return results;
};

window.keyPressed = () => {
  if (key === 'ArrowRight') {
    click('next');
  }
  if (key === 'ArrowLeft') {
    click('prev');
  }
  if (key === 'ArrowUp') {
    click('up');
  }
  if (key === 'ArrowDown') {
    click('down');
  }
  if (key === ' ') {
    click('flip');
  }
  if (key === 'Home') {
    click('first');
  }
  if (key === 'End') {
    click('last');
  }
  return xdraw();
};

window.mousePressed = () => {
  var button, i, len, ref;
  ref = global.buttons.concat(global.board.buttons);
  for (i = 0, len = ref.length; i < len; i++) {
    button = ref[i];
    if (button.inside(mouseX, mouseY)) {
      button.onclick();
      xdraw();
      return;
    }
  }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUEsSUFBQSxFQUFBLEtBQUEsRUFBQTs7QUFBQSxPQUFPLENBQVAsTUFBQTs7QUFDQSxPQUFBO0VBQVEsR0FBUjtFQUFZLEdBQVo7RUFBZ0IsS0FBaEI7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxLQUFSO0NBQUEsTUFBQTs7QUFDQSxPQUFBO0VBQVEsTUFBUjtDQUFBLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLE1BQVI7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxRQUFSO0VBQWlCLFFBQWpCO0VBQTBCLEtBQTFCO0VBQWdDLFFBQWhDO0VBQXlDLE1BQXpDO0NBQUEsTUFBQTs7QUFFQSxJQUFBLEdBQU8sTUFBTSxDQUFDLEtBUGQ7Ozs7Ozs7Ozs7QUFpQkEsTUFBTSxDQUFDLFFBQVAsR0FBa0I7O0FBRWxCLE1BQU0sQ0FBQyxPQUFQLEdBQWlCLENBQUEsQ0FBQSxHQUFBO0FBQ2pCLE1BQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxFQUFBLE1BQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxFQUFBO0VBQUMsTUFBTSxDQUFDLElBQVAsR0FBYyxRQUFBLENBQVMsU0FBQSxHQUFZLE1BQU0sQ0FBQyxRQUE1QjtBQUNkO0VBQUEsS0FBQSxxQ0FBQTs7SUFDQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQUQsQ0FBWCxHQUFzQixTQUFBLENBQVUsWUFBQSxHQUFlLE1BQWYsR0FBd0IsTUFBbEM7RUFEdkI7QUFFQTtBQUFBO0VBQUEsS0FBQSx3Q0FBQTs7aUJBQ0MsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFELENBQVgsR0FBc0IsU0FBQSxDQUFVLFlBQUEsR0FBZSxNQUFNLENBQUMsV0FBUCxDQUFBLENBQWYsR0FBc0MsTUFBaEQ7RUFEdkIsQ0FBQTs7QUFKZ0IsRUFuQmpCOzs7QUEy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QixLQUFBLENBQU0sTUFBTixFQUFuQjs7RUFDQSxJQUFHLEdBQUEsS0FBTyxNQUFWO0lBQXNCLEtBQUEsQ0FBTSxPQUFOLEVBQXRCOztFQUNBLElBQUcsR0FBQSxLQUFPLEtBQVY7SUFBcUIsS0FBQSxDQUFNLE1BQU4sRUFBckI7O1NBQ0EsS0FBQSxDQUFBO0FBUm1COztBQVVwQixNQUFNLENBQUMsWUFBUCxHQUFzQixDQUFBLENBQUEsR0FBQTtBQUN0QixNQUFBLE1BQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBO0FBQUM7RUFBQSxLQUFBLHFDQUFBOztJQUNDLElBQUcsTUFBTSxDQUFDLE1BQVAsQ0FBYyxNQUFkLEVBQXFCLE1BQXJCLENBQUg7TUFDQyxNQUFNLENBQUMsT0FBUCxDQUFBO01BQ0EsS0FBQSxDQUFBO0FBQ0EsYUFIRDs7RUFERDtBQURxQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfICAgICAgICAgICBmcm9tICdodHRwczovL2Nkbi5za3lwYWNrLmRldi9sb2Rhc2gnXHJcbmltcG9ydCB7YXNzLGxvZyxyYW5nZX0gZnJvbSAnLi4vanMvdXRpbHMuanMnXHJcbmltcG9ydCB7Qm9hcmR9IGZyb20gJy4uL2pzL2JvYXJkLmpzJ1xyXG5pbXBvcnQge0J1dHRvbn0gZnJvbSAnLi4vanMvYnV0dG9uLmpzJ1xyXG5pbXBvcnQge1NxdWFyZX0gZnJvbSAnLi4vanMvc3F1YXJlLmpzJ1xyXG5pbXBvcnQge21ha2VNb3ZlLHNldEluZGV4LGNsaWNrLGZpeFN1cGVyLGdsb2JhbH0gZnJvbSAnLi4vanMvZ2xvYmFscy5qcydcclxuXHJcblNJWkUgPSBnbG9iYWwuU0laRVxyXG5cclxuI2dsb2JhbC5maWxlbmFtZSA9ICdsaWNoZXNzX3Bnbl8yMDIzLjAzLjMwX0NocmlzdGVyTmlsc3Nvbl92c19hc3NtYW42OTQyMC5IYUJKSHJpdy5qc29uJ1xyXG4jZ2xvYmFsLmZpbGVuYW1lID0gJ0phbkNocmlzdGVyTmlsc3Nvbl92c19kbjEwMjNfMjAyMy4wMy4yOS5qc29uJ1xyXG4jZ2xvYmFsLmZpbGVuYW1lID0gXCJsaWNoZXNzX3Bnbl8yMDIzLjAzLjMxX09udXIxOTA3LTA2X3ZzX0NocmlzdGVyTmlsc3Nvbi5CRlVZa25FcC5qc29uXCJcclxuI2dsb2JhbC5maWxlbmFtZSA9IFwibGljaGVzc19wZ25fMjAyMy4wMy4zMV9DaHJpc3Rlck5pbHNzb25fdnNfYXJhcG9wLmtFbElnVjV1Lmpzb25cIlxyXG4jZ2xvYmFsLmZpbGVuYW1lID1cImxpY2hlc3NfcGduXzIwMjMuMDQuMDFfTW9oYW1lZEZhZGVsMTIzX3ZzX0NocmlzdGVyTmlsc3Nvbi1EMTUuTXlKVm9jMlkuanNvblwiXHJcbiNnbG9iYWwuZmlsZW5hbWUgPVwibGljaGVzc19wZ25fMjAyMy4wNC4wMV9raW5nMTk3MV92c19DaHJpc3Rlck5pbHNzb24uN2FQd1Z3OUEuanNvblwiXHJcbiNnbG9iYWwuZmlsZW5hbWUgPVwibGljaGVzc19wZ25fMjAyMy4wNC4wM19tYXRoZXdqb2huMTk2NV92c19DaHJpc3Rlck5pbHNzb24uaHduVmFKWm8uanNvblwiXHJcbiNnbG9iYWwuZmlsZW5hbWUgPSBcIkJvYmJ5IEZpc2NoZXJfdnNfQm9yaXMgViBTcGFzc2t5XzE5OTIuX18uX18uanNvblwiXHJcbmdsb2JhbC5maWxlbmFtZSA9IFwiSGlrYXJ1X3ZzX19fX19fXy5fXy5fXy5qc29uXCJcclxuXHJcbndpbmRvdy5wcmVsb2FkID0gPT5cclxuXHRnbG9iYWwuZGF0YSA9IGxvYWRKU09OICcuL2RhdGEvJyArIGdsb2JhbC5maWxlbmFtZVxyXG5cdGZvciBsZXR0ZXIgaW4gXCJybmJxa3BcIlxyXG5cdFx0Z2xvYmFsLnBpY3NbbGV0dGVyXSA9IGxvYWRJbWFnZSAnLi9pbWFnZXMvYicgKyBsZXR0ZXIgKyAnLnBuZydcclxuXHRmb3IgbGV0dGVyIGluIFwiUk5CUUtQXCJcclxuXHRcdGdsb2JhbC5waWNzW2xldHRlcl0gPSBsb2FkSW1hZ2UgJy4vaW1hZ2VzL3cnICsgbGV0dGVyLnRvTG93ZXJDYXNlKCkgKyAnLnBuZydcclxuXHJcbiMgdGhlcmUgaXMgYSBidWcgaW4gc3BsaXRcclxuc3BsaXQgPSAocylcdC0+IGlmIHM9PVwiXCIgdGhlbiByZXR1cm4gW10gZWxzZSByZXR1cm4gcy5zcGxpdCBcIiBcIlxyXG5cclxud2luZG93LnNldHVwID0gPT5cclxuXHRjcmVhdGVDYW52YXMgU0laRSoxMC4zLCBTSVpFKjExXHJcblxyXG5cdHRleHRBbGlnbiBDRU5URVIsQ0VOVEVSXHJcblx0cmVjdE1vZGUgQ0VOVEVSXHJcblxyXG5cdGdsb2JhbC5ib2FyZCA9IG5ldyBCb2FyZCgpXHJcblxyXG5cdCMgWzEsIDM1LCBcImU1XCIsIFwiYzUgZDUgYzYgTmM2XCIsIFwiZTdlNVwiLCBcImM3YzUgZDdkNSBjN2M2IGI4YzZcIl0sXHJcblxyXG5cdGdsb2JhbC5tb3ZlcyA9IGdsb2JhbC5kYXRhLnBsaWVzXHJcblx0Z2xvYmFsLm1vdmVzID0gXy5tYXAgZ2xvYmFsLm1vdmVzLCAobW92ZSkgPT5cclxuXHRcdHNjb3JlID0gbW92ZVsxXVxyXG5cdFx0c2FuID0gbW92ZVsyXVxyXG5cdFx0c3VwZXJpb3JzU2FuID0gc3BsaXQgbW92ZVszXVxyXG5cdFx0dWNpID0gbW92ZVs0XVxyXG5cdFx0c3VwZXJpb3JzID0gc3BsaXQgbW92ZVs1XVxyXG5cdFx0c2NvcmVzID0gc3BsaXQgbW92ZVs2XVxyXG5cdFx0c3VwZXJpb3JzU2FuID0gc3VwZXJpb3JzU2FuLnNsaWNlIDAsMTJcclxuXHRcdHN1cGVyaW9ycyA9IHN1cGVyaW9ycy5zbGljZSAwLDEyXHJcblx0XHQjc3VwZXJpb3JzU2FuLnJldmVyc2UoKVxyXG5cdFx0I3N1cGVyaW9ycy5yZXZlcnNlKClcclxuXHRcdCNzY29yZXMucmV2ZXJzZSgpXHJcblx0XHR7c2NvcmUsIHVjaSwgc2FuLCBzdXBlcmlvcnMsIHN1cGVyaW9yc1Nhbiwgc2NvcmVzfVxyXG5cdGdsb2JhbC5waWVjZXNzLnB1c2ggZ2xvYmFsLmJvYXJkLnBpZWNlc1xyXG5cclxuXHRmb3IgbW92ZSBpbiBnbG9iYWwubW92ZXNcclxuXHRcdGdsb2JhbC5ib2FyZC5waWVjZXMgPSBtYWtlTW92ZSBtb3ZlLnVjaSwgXy5sYXN0IGdsb2JhbC5waWVjZXNzXHJcblx0XHRnbG9iYWwucGllY2Vzcy5wdXNoIGdsb2JhbC5ib2FyZC5waWVjZXNcclxuXHJcblx0c2V0SW5kZXggMCAjIHRvbXQgYnLDpGRlXHJcblxyXG5cdHhkcmF3KClcclxuXHJcbnhkcmF3ID0gPT5cclxuXHRiYWNrZ3JvdW5kICdncmF5J1xyXG5cdHRleHRTaXplIFNJWkVcclxuXHRnbG9iYWwuYm9hcmQuZHJhdygpXHJcblx0Zm9yIGJ1dHRvbiBpbiBnbG9iYWwuYnV0dG9uc1xyXG5cdFx0YnV0dG9uLmRyYXcoKVxyXG5cclxud2luZG93LmtleVByZXNzZWQgPSA9PlxyXG5cdGlmIGtleSA9PSAnQXJyb3dSaWdodCcgIHRoZW4gY2xpY2sgJ25leHQnXHJcblx0aWYga2V5ID09ICdBcnJvd0xlZnQnIHRoZW4gY2xpY2sgJ3ByZXYnXHJcblx0aWYga2V5ID09ICdBcnJvd1VwJyAgdGhlbiBjbGljayAndXAnXHJcblx0aWYga2V5ID09ICdBcnJvd0Rvd24nIHRoZW4gY2xpY2sgJ2Rvd24nXHJcblx0aWYga2V5ID09ICcgJyB0aGVuIGNsaWNrICdmbGlwJ1xyXG5cdGlmIGtleSA9PSAnSG9tZScgdGhlbiBjbGljayAnZmlyc3QnXHJcblx0aWYga2V5ID09ICdFbmQnIHRoZW4gY2xpY2sgJ2xhc3QnXHJcblx0eGRyYXcoKVxyXG5cclxud2luZG93Lm1vdXNlUHJlc3NlZCA9ID0+XHJcblx0Zm9yIGJ1dHRvbiBpbiBnbG9iYWwuYnV0dG9ucy5jb25jYXQgZ2xvYmFsLmJvYXJkLmJ1dHRvbnNcclxuXHRcdGlmIGJ1dHRvbi5pbnNpZGUgbW91c2VYLG1vdXNlWVxyXG5cdFx0XHRidXR0b24ub25jbGljaygpXHJcblx0XHRcdHhkcmF3KClcclxuXHRcdFx0cmV0dXJuXHJcbiJdfQ==
//# sourceURL=c:\github\2023-018-Python-Chess_Evaluate\coffee\sketch.coffee