// Generated by CoffeeScript 2.5.1
var SIZE, split, xdraw;

import _ from 'https://cdn.skypack.dev/lodash';

import {
  ass,
  log,
  range
} from '../js/utils.js';

import {
  Board
} from '../js/board.js';

import {
  Button
} from '../js/button.js';

import {
  Square
} from '../js/square.js';

import {
  makeMove,
  setIndex,
  click,
  fixSuper,
  global
} from '../js/globals.js';

SIZE = global.SIZE;

//global.filename = 'lichess_pgn_2023.03.30_ChristerNilsson_vs_assman69420.HaBJHriw.json'
//global.filename = 'JanChristerNilsson_vs_dn1023_2023.03.29.json'
//global.filename = "lichess_pgn_2023.03.31_Onur1907-06_vs_ChristerNilsson.BFUYknEp.json"
//global.filename = "lichess_pgn_2023.03.31_ChristerNilsson_vs_arapop.kElIgV5u.json"
//global.filename ="lichess_pgn_2023.04.01_MohamedFadel123_vs_ChristerNilsson-D15.MyJVoc2Y.json"
//global.filename ="lichess_pgn_2023.04.01_king1971_vs_ChristerNilsson.7aPwVw9A.json"
//global.filename ="lichess_pgn_2023.04.03_mathewjohn1965_vs_ChristerNilsson.hwnVaJZo.json"
//global.filename = "Bobby Fischer_vs_Boris V Spassky_1992.__.__.json"
global.filename = "Hikaru_vs_______.__.__.json";

window.preload = () => {
  var i, j, len, len1, letter, ref, ref1, results;
  global.data = loadJSON('../data/' + global.filename);
  ref = "rnbqkp";
  for (i = 0, len = ref.length; i < len; i++) {
    letter = ref[i];
    global.pics[letter] = loadImage('images/b' + letter + '.png');
  }
  ref1 = "RNBQKP";
  results = [];
  for (j = 0, len1 = ref1.length; j < len1; j++) {
    letter = ref1[j];
    results.push(global.pics[letter] = loadImage('images/w' + letter + '.png'));
  }
  return results;
};

// there is a bug in split
split = function(s) {
  if (s === "") {
    return [];
  } else {
    return s.split(" ");
  }
};

window.setup = () => {
  var i, len, move, ref;
  createCanvas(SIZE * 10.3, SIZE * 11);
  textAlign(CENTER, CENTER);
  rectMode(CENTER);
  global.board = new Board();
  // [1, 35, "e5", "c5 d5 c6 Nc6", "e7e5", "c7c5 d7d5 c7c6 b8c6"],
  global.moves = global.data.plies;
  global.moves = _.map(global.moves, (move) => {
    var san, score, scores, superiors, superiorsSan, uci;
    score = move[1];
    san = move[2];
    superiorsSan = split(move[3]);
    uci = move[4];
    superiors = split(move[5]);
    scores = split(move[6]);
    superiorsSan = superiorsSan.slice(0, 12);
    superiors = superiors.slice(0, 12);
    //superiorsSan.reverse()
    //superiors.reverse()
    //scores.reverse()
    return {score, uci, san, superiors, superiorsSan, scores};
  });
  global.piecess.push(global.board.pieces);
  ref = global.moves;
  for (i = 0, len = ref.length; i < len; i++) {
    move = ref[i];
    global.board.pieces = makeMove(move.uci, _.last(global.piecess));
    global.piecess.push(global.board.pieces);
  }
  setIndex(0); // tomt brÃ¤de
  return xdraw();
};

xdraw = () => {
  var button, i, len, ref, results;
  background('gray');
  textSize(SIZE);
  global.board.draw();
  ref = global.buttons;
  results = [];
  for (i = 0, len = ref.length; i < len; i++) {
    button = ref[i];
    results.push(button.draw());
  }
  return results;
};

window.keyPressed = () => {
  if (key === 'ArrowRight') {
    click('next');
  }
  if (key === 'ArrowLeft') {
    click('prev');
  }
  if (key === 'ArrowUp') {
    click('up');
  }
  if (key === 'ArrowDown') {
    click('down');
  }
  if (key === ' ') {
    click('flip');
  }
  if (key === 'Home') {
    click('first');
  }
  if (key === 'End') {
    click('last');
  }
  return xdraw();
};

window.mousePressed = () => {
  var button, i, len, ref;
  ref = global.buttons.concat(global.board.buttons);
  for (i = 0, len = ref.length; i < len; i++) {
    button = ref[i];
    if (button.inside(mouseX, mouseY)) {
      button.onclick();
      xdraw();
      return;
    }
  }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUEsSUFBQSxFQUFBLEtBQUEsRUFBQTs7QUFBQSxPQUFPLENBQVAsTUFBQTs7QUFDQSxPQUFBO0VBQVEsR0FBUjtFQUFZLEdBQVo7RUFBZ0IsS0FBaEI7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxLQUFSO0NBQUEsTUFBQTs7QUFDQSxPQUFBO0VBQVEsTUFBUjtDQUFBLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLE1BQVI7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxRQUFSO0VBQWlCLFFBQWpCO0VBQTBCLEtBQTFCO0VBQWdDLFFBQWhDO0VBQXlDLE1BQXpDO0NBQUEsTUFBQTs7QUFFQSxJQUFBLEdBQU8sTUFBTSxDQUFDLEtBUGQ7Ozs7Ozs7Ozs7QUFpQkEsTUFBTSxDQUFDLFFBQVAsR0FBa0I7O0FBRWxCLE1BQU0sQ0FBQyxPQUFQLEdBQWlCLENBQUEsQ0FBQSxHQUFBO0FBQ2pCLE1BQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxFQUFBLE1BQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxFQUFBO0VBQUMsTUFBTSxDQUFDLElBQVAsR0FBYyxRQUFBLENBQVMsVUFBQSxHQUFhLE1BQU0sQ0FBQyxRQUE3QjtBQUNkO0VBQUEsS0FBQSxxQ0FBQTs7SUFDQyxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQUQsQ0FBWCxHQUFzQixTQUFBLENBQVUsVUFBQSxHQUFhLE1BQWIsR0FBc0IsTUFBaEM7RUFEdkI7QUFFQTtBQUFBO0VBQUEsS0FBQSx3Q0FBQTs7aUJBQ0MsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFELENBQVgsR0FBc0IsU0FBQSxDQUFVLFVBQUEsR0FBYSxNQUFiLEdBQXNCLE1BQWhDO0VBRHZCLENBQUE7O0FBSmdCLEVBbkJqQjs7O0FBMkJBLEtBQUEsR0FBUSxRQUFBLENB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bkI7O0VBQ0EsSUFBRyxHQUFBLEtBQU8sTUFBVjtJQUFzQixLQUFBLENBQU0sT0FBTixFQUF0Qjs7RUFDQSxJQUFHLEdBQUEsS0FBTyxLQUFWO0lBQXFCLEtBQUEsQ0FBTSxNQUFOLEVBQXJCOztTQUNBLEtBQUEsQ0FBQTtBQVJtQjs7QUFVcEIsTUFBTSxDQUFDLFlBQVAsR0FBc0IsQ0FBQSxDQUFBLEdBQUE7QUFDdEIsTUFBQSxNQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsRUFBQTtBQUFDO0VBQUEsS0FBQSxxQ0FBQTs7SUFDQyxJQUFHLE1BQU0sQ0FBQyxNQUFQLENBQWMsTUFBZCxFQUFxQixNQUFyQixDQUFIO01BQ0MsTUFBTSxDQUFDLE9BQVAsQ0FBQTtNQUNBLEtBQUEsQ0FBQTtBQUNBLGFBSEQ7O0VBREQ7QUFEcUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyAgICAgICAgICAgZnJvbSAnaHR0cHM6Ly9jZG4uc2t5cGFjay5kZXYvbG9kYXNoJ1xyXG5pbXBvcnQge2Fzcyxsb2cscmFuZ2V9IGZyb20gJy4uL2pzL3V0aWxzLmpzJ1xyXG5pbXBvcnQge0JvYXJkfSBmcm9tICcuLi9qcy9ib2FyZC5qcydcclxuaW1wb3J0IHtCdXR0b259IGZyb20gJy4uL2pzL2J1dHRvbi5qcydcclxuaW1wb3J0IHtTcXVhcmV9IGZyb20gJy4uL2pzL3NxdWFyZS5qcydcclxuaW1wb3J0IHttYWtlTW92ZSxzZXRJbmRleCxjbGljayxmaXhTdXBlcixnbG9iYWx9IGZyb20gJy4uL2pzL2dsb2JhbHMuanMnXHJcblxyXG5TSVpFID0gZ2xvYmFsLlNJWkVcclxuXHJcbiNnbG9iYWwuZmlsZW5hbWUgPSAnbGljaGVzc19wZ25fMjAyMy4wMy4zMF9DaHJpc3Rlck5pbHNzb25fdnNfYXNzbWFuNjk0MjAuSGFCSkhyaXcuanNvbidcclxuI2dsb2JhbC5maWxlbmFtZSA9ICdKYW5DaHJpc3Rlck5pbHNzb25fdnNfZG4xMDIzXzIwMjMuMDMuMjkuanNvbidcclxuI2dsb2JhbC5maWxlbmFtZSA9IFwibGljaGVzc19wZ25fMjAyMy4wMy4zMV9PbnVyMTkwNy0wNl92c19DaHJpc3Rlck5pbHNzb24uQkZVWWtuRXAuanNvblwiXHJcbiNnbG9iYWwuZmlsZW5hbWUgPSBcImxpY2hlc3NfcGduXzIwMjMuMDMuMzFfQ2hyaXN0ZXJOaWxzc29uX3ZzX2FyYXBvcC5rRWxJZ1Y1dS5qc29uXCJcclxuI2dsb2JhbC5maWxlbmFtZSA9XCJsaWNoZXNzX3Bnbl8yMDIzLjA0LjAxX01vaGFtZWRGYWRlbDEyM192c19DaHJpc3Rlck5pbHNzb24tRDE1Lk15SlZvYzJZLmpzb25cIlxyXG4jZ2xvYmFsLmZpbGVuYW1lID1cImxpY2hlc3NfcGduXzIwMjMuMDQuMDFfa2luZzE5NzFfdnNfQ2hyaXN0ZXJOaWxzc29uLjdhUHdWdzlBLmpzb25cIlxyXG4jZ2xvYmFsLmZpbGVuYW1lID1cImxpY2hlc3NfcGduXzIwMjMuMDQuMDNfbWF0aGV3am9objE5NjVfdnNfQ2hyaXN0ZXJOaWxzc29uLmh3blZhSlpvLmpzb25cIlxyXG4jZ2xvYmFsLmZpbGVuYW1lID0gXCJCb2JieSBGaXNjaGVyX3ZzX0JvcmlzIFYgU3Bhc3NreV8xOTkyLl9fLl9fLmpzb25cIlxyXG5nbG9iYWwuZmlsZW5hbWUgPSBcIkhpa2FydV92c19fX19fX18uX18uX18uanNvblwiXHJcblxyXG53aW5kb3cucHJlbG9hZCA9ID0+XHJcblx0Z2xvYmFsLmRhdGEgPSBsb2FkSlNPTiAnLi4vZGF0YS8nICsgZ2xvYmFsLmZpbGVuYW1lXHJcblx0Zm9yIGxldHRlciBpbiBcInJuYnFrcFwiXHJcblx0XHRnbG9iYWwucGljc1tsZXR0ZXJdID0gbG9hZEltYWdlICdpbWFnZXMvYicgKyBsZXR0ZXIgKyAnLnBuZydcclxuXHRmb3IgbGV0dGVyIGluIFwiUk5CUUtQXCJcclxuXHRcdGdsb2JhbC5waWNzW2xldHRlcl0gPSBsb2FkSW1hZ2UgJ2ltYWdlcy93JyArIGxldHRlciArICcucG5nJ1xyXG5cclxuIyB0aGVyZSBpcyBhIGJ1ZyBpbiBzcGxpdFxyXG5zcGxpdCA9IChzKVx0LT4gaWYgcz09XCJcIiB0aGVuIHJldHVybiBbXSBlbHNlIHJldHVybiBzLnNwbGl0IFwiIFwiXHJcblxyXG53aW5kb3cuc2V0dXAgPSA9PlxyXG5cdGNyZWF0ZUNhbnZhcyBTSVpFKjEwLjMsIFNJWkUqMTFcclxuXHJcblx0dGV4dEFsaWduIENFTlRFUixDRU5URVJcclxuXHRyZWN0TW9kZSBDRU5URVJcclxuXHJcblx0Z2xvYmFsLmJvYXJkID0gbmV3IEJvYXJkKClcclxuXHJcblx0IyBbMSwgMzUsIFwiZTVcIiwgXCJjNSBkNSBjNiBOYzZcIiwgXCJlN2U1XCIsIFwiYzdjNSBkN2Q1IGM3YzYgYjhjNlwiXSxcclxuXHJcblx0Z2xvYmFsLm1vdmVzID0gZ2xvYmFsLmRhdGEucGxpZXNcclxuXHRnbG9iYWwubW92ZXMgPSBfLm1hcCBnbG9iYWwubW92ZXMsIChtb3ZlKSA9PlxyXG5cdFx0c2NvcmUgPSBtb3ZlWzFdXHJcblx0XHRzYW4gPSBtb3ZlWzJdXHJcblx0XHRzdXBlcmlvcnNTYW4gPSBzcGxpdCBtb3ZlWzNdXHJcblx0XHR1Y2kgPSBtb3ZlWzRdXHJcblx0XHRzdXBlcmlvcnMgPSBzcGxpdCBtb3ZlWzVdXHJcblx0XHRzY29yZXMgPSBzcGxpdCBtb3ZlWzZdXHJcblx0XHRzdXBlcmlvcnNTYW4gPSBzdXBlcmlvcnNTYW4uc2xpY2UgMCwxMlxyXG5cdFx0c3VwZXJpb3JzID0gc3VwZXJpb3JzLnNsaWNlIDAsMTJcclxuXHRcdCNzdXBlcmlvcnNTYW4ucmV2ZXJzZSgpXHJcblx0XHQjc3VwZXJpb3JzLnJldmVyc2UoKVxyXG5cdFx0I3Njb3Jlcy5yZXZlcnNlKClcclxuXHRcdHtzY29yZSwgdWNpLCBzYW4sIHN1cGVyaW9ycywgc3VwZXJpb3JzU2FuLCBzY29yZXN9XHJcblx0Z2xvYmFsLnBpZWNlc3MucHVzaCBnbG9iYWwuYm9hcmQucGllY2VzXHJcblxyXG5cdGZvciBtb3ZlIGluIGdsb2JhbC5tb3Zlc1xyXG5cdFx0Z2xvYmFsLmJvYXJkLnBpZWNlcyA9IG1ha2VNb3ZlIG1vdmUudWNpLCBfLmxhc3QgZ2xvYmFsLnBpZWNlc3NcclxuXHRcdGdsb2JhbC5waWVjZXNzLnB1c2ggZ2xvYmFsLmJvYXJkLnBpZWNlc1xyXG5cclxuXHRzZXRJbmRleCAwICMgdG9tdCBicsOkZGVcclxuXHJcblx0eGRyYXcoKVxyXG5cclxueGRyYXcgPSA9PlxyXG5cdGJhY2tncm91bmQgJ2dyYXknXHJcblx0dGV4dFNpemUgU0laRVxyXG5cdGdsb2JhbC5ib2FyZC5kcmF3KClcclxuXHRmb3IgYnV0dG9uIGluIGdsb2JhbC5idXR0b25zXHJcblx0XHRidXR0b24uZHJhdygpXHJcblxyXG53aW5kb3cua2V5UHJlc3NlZCA9ID0+XHJcblx0aWYga2V5ID09ICdBcnJvd1JpZ2h0JyAgdGhlbiBjbGljayAnbmV4dCdcclxuXHRpZiBrZXkgPT0gJ0Fycm93TGVmdCcgdGhlbiBjbGljayAncHJldidcclxuXHRpZiBrZXkgPT0gJ0Fycm93VXAnICB0aGVuIGNsaWNrICd1cCdcclxuXHRpZiBrZXkgPT0gJ0Fycm93RG93bicgdGhlbiBjbGljayAnZG93bidcclxuXHRpZiBrZXkgPT0gJyAnIHRoZW4gY2xpY2sgJ2ZsaXAnXHJcblx0aWYga2V5ID09ICdIb21lJyB0aGVuIGNsaWNrICdmaXJzdCdcclxuXHRpZiBrZXkgPT0gJ0VuZCcgdGhlbiBjbGljayAnbGFzdCdcclxuXHR4ZHJhdygpXHJcblxyXG53aW5kb3cubW91c2VQcmVzc2VkID0gPT5cclxuXHRmb3IgYnV0dG9uIGluIGdsb2JhbC5idXR0b25zLmNvbmNhdCBnbG9iYWwuYm9hcmQuYnV0dG9uc1xyXG5cdFx0aWYgYnV0dG9uLmluc2lkZSBtb3VzZVgsbW91c2VZXHJcblx0XHRcdGJ1dHRvbi5vbmNsaWNrKClcclxuXHRcdFx0eGRyYXcoKVxyXG5cdFx0XHRyZXR1cm5cclxuIl19
//# sourceURL=c:\github\2023-018-Python-Chess_Evaluate\coffee\sketch.coffee